--- kdebase.orig/konqueror/src/CMakeLists.txt	2008-04-28 09:47:29.000000000 +0000
+++ kdebase/konqueror/src/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -13,6 +13,7 @@
 configure_file(config-konqueror.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config-konqueror.h )
 
 # For crc32 in konqhistorymanager.cpp
+find_package(ZLIB REQUIRED)
 include_directories( ${ZLIB_INCLUDE_DIR} )
 
 ########### libkonquerorprivate, shared with sidebar modules ###############
@@ -26,7 +27,7 @@
 qt4_add_dbus_adaptor(konquerorprivate_SRCS org.kde.Konqueror.HistoryManager.xml konqhistorymanager.h KonqHistoryManager konqhistorymanageradaptor KonqHistoryManagerAdaptor)
 
 kde4_add_library(konquerorprivate SHARED ${konquerorprivate_SRCS})
-target_link_libraries(konquerorprivate ${KDE4_KPARTS_LIBS})
+target_link_libraries(konquerorprivate ${KDE4_KPARTS_LIBS} ${QT_QTDBUS_LIBRARY} ${ZLIB_LIBRARY})
 set_target_properties(konquerorprivate PROPERTIES VERSION ${GENERIC_LIB_VERSION} SOVERSION ${GENERIC_LIB_SOVERSION} )
 install(TARGETS konquerorprivate ${INSTALL_TARGETS_DEFAULT_ARGS})
 
@@ -74,7 +75,7 @@
 qt4_add_dbus_interface(konqueror_KDEINIT_SRCS org.kde.Konqueror.UndoManager.xml konqundomanager_interface)
 
 kde4_add_kdeinit_executable(konqueror ${konqueror_KDEINIT_SRCS} konqmain.cpp)
-target_link_libraries(kdeinit_konqueror konquerorprivate konq ${KDE4_KPARTS_LIBS} ${KDE4_KUTILS_LIBS})
+target_link_libraries(kdeinit_konqueror konquerorprivate konq ${KDE4_KPARTS_LIBS} ${KDE4_KUTILS_LIBS} ${X11_X11_LIB})
 
 kde4_add_app_icon(konqueror_KDEINIT_SRCS "${KDE4_ICON_INSTALL_DIR}/oxygen/*/apps/konqueror.png")
 
--- kdebase.orig/lib/konq/CMakeLists.txt	2008-04-28 09:48:17.000000000 +0000
+++ kdebase/lib/konq/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -23,7 +23,7 @@
 
 kde4_add_library(konq SHARED ${konq_LIB_SRCS})
 
-target_link_libraries(konq ${QT_QTXML_LIBRARY} ${KDE4_KPARTS_LIBS})
+target_link_libraries(konq ${QT_QTXML_LIBRARY} ${KDE4_KPARTS_LIBS} ${QT_QTDBUS_LIBRARY})
 
 set_target_properties(konq PROPERTIES VERSION ${KDE_NON_GENERIC_LIB_VERSION} SOVERSION ${KDE_NON_GENERIC_LIB_SOVERSION} )
 install(TARGETS konq  ${INSTALL_TARGETS_DEFAULT_ARGS})
--- kdebase.orig/lib/konq/favicons/CMakeLists.txt	2008-04-28 09:48:17.000000000 +0000
+++ kdebase/lib/konq/favicons/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -4,7 +4,7 @@
 
 kde4_add_plugin(kded_favicons ${kded_favicons_SRCS})
 
-target_link_libraries( kded_favicons ${KDE4_KIO_LIBS} )
+target_link_libraries( kded_favicons ${KDE4_KIO_LIBS} ${QT_QTDBUS_LIBRARY} )
 
 
 install(TARGETS kded_favicons  DESTINATION ${PLUGIN_INSTALL_DIR} )
--- kdebase.orig/konqueror/client/CMakeLists.txt	2008-04-28 09:47:46.000000000 +0000
+++ kdebase/konqueror/client/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -16,7 +16,7 @@
     target_link_libraries(kfmclient  ${KDE4_KIO_LIBS} )
 else (WIN32)
     kde4_add_kdeinit_executable( kfmclient NOGUI ${kfmclient_SRCS})
-    target_link_libraries(kdeinit_kfmclient  ${KDE4_KIO_LIBS} )
+target_link_libraries(kdeinit_kfmclient  ${KDE4_KIO_LIBS} ${QT_QTDBUS_LIBRARY} ${X11_X11_LIB} )
     install(TARGETS kdeinit_kfmclient  ${INSTALL_TARGETS_DEFAULT_ARGS} )
 endif (WIN32)
 
--- kdebase.orig/konqueror/preloader/CMakeLists.txt	2008-04-28 09:47:46.000000000 +0000
+++ kdebase/konqueror/preloader/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -13,7 +13,7 @@
 
 kde4_add_plugin(kded_konqy_preloader ${kded_konqy_preloader_PART_SRCS})
 
-target_link_libraries(kded_konqy_preloader ${KDE4_KDEUI_LIBS})
+target_link_libraries(kded_konqy_preloader ${KDE4_KDEUI_LIBS} ${QT_QTDBUS_LIBRARY})
 
 install(TARGETS kded_konqy_preloader DESTINATION ${PLUGIN_INSTALL_DIR})
 
--- kdebase.orig/konqueror/settings/kio/CMakeLists.txt	2008-04-28 09:47:36.000000000 +0000
+++ kdebase/konqueror/settings/kio/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -31,7 +31,7 @@
 kde4_add_plugin(kcm_kio ${kcm_kio_PART_SRCS})
 
 
-target_link_libraries(kcm_kio  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KUTILS_LIBS} )
+target_link_libraries(kcm_kio  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KUTILS_LIBS} ${QT_QTDBUS_LIBRARY} )
 
 install(TARGETS kcm_kio  DESTINATION ${PLUGIN_INSTALL_DIR} )
 
--- kdebase.orig/konqueror/settings/konq/CMakeLists.txt	2008-04-28 09:47:39.000000000 +0000
+++ kdebase/konqueror/settings/konq/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -22,7 +22,7 @@
 kde4_add_plugin(kcm_konq ${kcm_konq_PART_SRCS})
 
 
-target_link_libraries(kcm_konq  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KUTILS_LIBS} )
+target_link_libraries(kcm_konq  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KUTILS_LIBS} ${QT_QTDBUS_LIBRARY} )
 
 install(TARGETS kcm_konq  DESTINATION ${PLUGIN_INSTALL_DIR} )
 
--- kdebase.orig/konqueror/settings/konqhtml/CMakeLists.txt	2008-04-28 09:47:40.000000000 +0000
+++ kdebase/konqueror/settings/konqhtml/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -22,7 +22,7 @@
 kde4_add_plugin(kcm_konqhtml ${kcm_konqhtml_PART_SRCS})
 
 
-target_link_libraries(kcm_konqhtml  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KHTML_LIBS})
+target_link_libraries(kcm_konqhtml  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KHTML_LIBS} ${QT_QTDBUS_LIBRARY})
 
 install(TARGETS kcm_konqhtml  DESTINATION ${PLUGIN_INSTALL_DIR} )
 
--- kdebase.orig/konqueror/settings/performance/CMakeLists.txt	2008-04-28 09:47:32.000000000 +0000
+++ kdebase/konqueror/settings/performance/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -11,7 +11,7 @@
 kde4_add_plugin(kcm_performance ${kcm_performance_PART_SRCS})
 
 
-target_link_libraries(kcm_performance  ${KDE4_KDEUI_LIBS} )
+target_link_libraries(kcm_performance  ${KDE4_KDEUI_LIBS} ${QT_QTDBUS_LIBRARY} )
 
 install(TARGETS kcm_performance  DESTINATION ${PLUGIN_INSTALL_DIR} )
 
--- kdebase.orig/kinfocenter/pci/CMakeLists.txt	2008-04-28 09:48:21.000000000 +0000
+++ kdebase/kinfocenter/pci/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -10,14 +10,14 @@
 
 if(PCIUTILS_FOUND)
     MESSAGE(STATUS "Enabling PCI module based on pciutils library")
-    
+
     add_definitions( -DHAVE_PCIUTILS )
 
     set(KCM_PCI_PART_SRCS kcm_pci.cpp ../base/os_current.cpp kpci.cpp )
 
     kde4_add_plugin(kcm_pci ${KCM_PCI_PART_SRCS})
 
-    target_link_libraries(kcm_pci ${KDE4_KDEUI_LIBS} ${QT_QTGUI_LIBRARY} ${PCIUTILS_LIBRARIES})
+    target_link_libraries(kcm_pci ${KDE4_KDEUI_LIBS} ${QT_QTGUI_LIBRARY} ${X11_X11_LIB} ${ZLIB_LIBRARY} ${PCIUTILS_LIBRARIES})
 
     
 else(PCIUTILS_FOUND)
@@ -26,7 +26,7 @@
 
     kde4_add_plugin(kcm_pci ${KCM_PCI_PART_SRCS})
     
-    target_link_libraries(kcm_pci  ${KDE4_KDEUI_LIBS} ${QT_QTGUI_LIBRARY} )
+    target_link_libraries(kcm_pci  ${KDE4_KDEUI_LIBS} ${QT_QTGUI_LIBRARY} ${X11_X11_LIB})
 endif(PCIUTILS_FOUND)
 
 install(TARGETS kcm_pci  DESTINATION ${PLUGIN_INSTALL_DIR})
--- kdebase.orig/konqueror/kttsplugin/CMakeLists.txt	2008-04-28 09:47:41.000000000 +0000
+++ kdebase/konqueror/kttsplugin/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -28,7 +28,7 @@
 
 kde4_add_plugin(khtmlkttsdplugin ${khtmlkttsdplugin_PART_SRCS})
 
-target_link_libraries(khtmlkttsdplugin  ${KDE4_KHTML_LIBS} )
+target_link_libraries(khtmlkttsdplugin  ${KDE4_KHTML_LIBS} ${QT_QTDBUS_LIBRARY} )
 
 if( WEBKITKDE_FOUND)
     target_link_libraries(khtmlkttsdplugin ${WEBKITKDE_LIBRARIES} ${QT_QTWEBKIT_LIBRARY} )
--- kdebase.orig/konsole/src/CMakeLists.txt	2008-04-28 09:48:34.000000000 +0000
+++ kdebase/konsole/src/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -82,7 +82,7 @@
 
 kde4_add_kdeinit_executable( konsole ${konsole_KDEINIT_SRCS})
 
-target_link_libraries(kdeinit_konsole ${KDE4_KPTY_LIBRARY} ${KDE4_KIO_LIBS} ${QT_QTXML_LIBRARY} ${KDE4_KNOTIFYCONFIG_LIBS} )
+target_link_libraries(kdeinit_konsole ${KDE4_KPTY_LIBRARY} ${KDE4_KIO_LIBS} ${QT_QTXML_LIBRARY} ${KDE4_KNOTIFYCONFIG_LIBS} ${QT_QTDBUS_LIBRARY} ${X11_X11_LIB} )
 
 # XRender library for true transparency support    
 if(X11_Xrender_FOUND)
@@ -155,7 +155,7 @@
 
 set_target_properties(konsolepart PROPERTIES DEFINE_SYMBOL KONSOLE_PART)
 
-target_link_libraries(konsolepart ${KDE4_KPARTS_LIBS} ${KDE4_KPTY_LIBRARY} ${KDE4_KIO_LIBS} ${KDE4_KNOTIFYCONFIG_LIBS})
+target_link_libraries(konsolepart ${KDE4_KPARTS_LIBS} ${KDE4_KPTY_LIBRARY} ${KDE4_KIO_LIBS} ${KDE4_KNOTIFYCONFIG_LIBS} ${QT_QTDBUS_LIBRARY} ${X11_X11_LIB})
 if(X11_Xrender_FOUND)
   target_link_libraries(konsolepart ${X11_Xrender_LIB})
 endif(X11_Xrender_FOUND)
--- kdebase.orig/nsplugins/CMakeLists.txt	2008-04-28 09:47:05.000000000 +0000
+++ kdebase/nsplugins/CMakeLists.txt	2008-04-28 21:04:55.000000000 +0000
@@ -26,7 +26,7 @@
 
   kde4_add_plugin(libnsplugin ${nsplugins_PART_SRCS})
 
-  target_link_libraries(libnsplugin  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KPARTS_LIBS} ${QT_QT3SUPPORT_LIBRARY} ${QT_QTGUI_LIBRARY} )
+target_link_libraries(libnsplugin  ${KDE4_KDE3SUPPORT_LIBS} ${KDE4_KPARTS_LIBS} ${QT_QT3SUPPORT_LIBRARY} ${QT_QTGUI_LIBRARY} ${QT_QTDBUS_LIBRARY} )
 
   install(TARGETS libnsplugin  DESTINATION ${PLUGIN_INSTALL_DIR} )
 
--- kdebase.orig/dolphin/src/CMakeLists.txt	2008-04-28 21:16:43.000000000 +0000
+++ kdebase/dolphin/src/CMakeLists.txt	2008-04-28 21:33:07.000000000 +0000
@@ -52,7 +52,16 @@
 
 configure_file(config-nepomuk.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config-nepomuk.h )
 
-target_link_libraries(dolphinprivate ${KDE4_KFILE_LIBS} konq ${BLITZ_LIBRARIES})
+target_link_libraries(dolphinprivate ${KDE4_KFILE_LIBS} konq ${BLITZ_LIBRARIES} )
+
+if (X11_FOUND)
+  target_link_libraries(dolphinprivate ${X11_X11_LIB})
+endif (X11_FOUND)
+if (X11_Xext_FOUND)
+  target_link_libraries(dolphinprivate ${X11_Xext_LIB})
+endif (X11_Xext_FOUND)
+
+
 if(X11_Xrender_FOUND)
   target_link_libraries(dolphinprivate ${X11_Xrender_LIB} )
 endif(X11_Xrender_FOUND)
